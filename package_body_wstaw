--body paczki która ma usprawnić wstawianie rekordów do tabel

create or replace package body wstaw
is
--krótki opis jak wywołać program
  procedure pomoc
  is
  begin
    tekst('Witamy w pomocy dla paczki wstaw. Żeby wstawić do bazy nowy:');
    tekst('-produkt wstaw.produkt (nazwa produktu)');
    tekst('-dostawca wstaw.dostawca (nazwa dostawcy, nr.tel, nr.konta)');
    tekst('-menu wstaw.pozycja_menu (nazwa poz. menu, cena, vat)');
    tekst('-recepture wstaw.receptura (nazwa dania, nazwa produktu, ilość, g/ml/szt.)następny produkt bez nazwy dania');
  end;

--wstawianie produktów
  procedure produkt(in_prod_name products.product_name%type)
  is
  begin
    insert into products(product_name)
    values (in_prod_name);
    tekst('wstawiono produkt: '||in_prod_name);
  end produkt;

--wstawianie dostawców
  procedure dostawca(in_supp_name suppliers.supplier_name%type, in_phon_numb suppliers.phone_number%type default null, in_bank_numb suppliers.bank_account_number%type default null)
  is
  begin
    insert into suppliers(supplier_name, phone_number, bank_account_number)
    values (in_supp_name, in_phon_numb, in_bank_numb);
    tekst('wstawiono dostawcę: '||in_supp_name||' z nr. tel '||in_phon_numb||' i nr. konta: '||in_bank_numb);
  end dostawca;

--wstawianie nowych pozycji menu
  procedure pozycja_menu(in_dish_name menu.dish_name%type, in_dish_price menu.dish_price%type, in_vat menu.vat%type)
  is
  begin
    insert into menu(dish_name, dish_price, vat)
    values (in_dish_name, in_dish_price, in_vat);
    tekst('wstawiono nowa pozycję menu: '||in_dish_name||' w cenie: '||in_dish_price||' z vatem: '||in_vat||'%');
  end pozycja_menu;

--funkcja zmieniająca nazwę produktu na jego id 
  function f_prod_id (in_prod_name products.product_name%type) return number
  is
    v_prod_id products.product_id%type;
  begin
    select product_id
    into v_prod_id
    from products
    where product_name = in_prod_name;

    return v_prod_id;
  end f_prod_id;
--funkcja zmieniająca nazwę pozycji menu na jego id  
  function f_menu_id (in_dish_name menu.dish_name%type) return number
  is
    v_menu_id menu.menu_id%type;
  begin
    select menu_id
    into v_menu_id
    from menu
    where dish_name = in_dish_name;
    
    return v_menu_id;
  end f_menu_id;
 
 --zbiór procedur które będą wstawiać rekordy do tabeli z recepturami 
 --procedury kożystają z funkcji zmieniających nazwę na id dzięki czemu osoba wstawiająca nie musi znać id
 --maksymalna ilość produktór z których składa się danie to 10 szt.
  procedure receptura_1 ( in_dish_name menu.dish_name%type, 
                        in_prod_name1 products.product_name%type, 
                        in_quan1 recipes.quantity%type, 
                        in_unit1 recipes.unit_code%type)
  is
    v_menu_id menu.menu_id%type;
    v_product_id products.product_id%type;
  begin
    v_menu_id := f_menu_id(in_dish_name);
    v_product_id := f_prod_id(in_prod_name1);
    
    insert into recipes (menu_id, product_id, quantity, unit_code)
    values (v_menu_id, v_product_id, in_quan1, in_unit1);
    tekst('wstawiono recepture na '||in_dish_name||' składajaca się z '||in_prod_name1||' w ilości '||in_quan1||in_unit1);
  end receptura_1;
  
  procedure receptura_2 (in_dish_name menu.dish_name%type,
                        in_prod_name2 products.product_name%type, 
                        in_quan2 recipes.quantity%type, 
                        in_unit2 recipes.unit_code%type)
  is
    v_menu_id menu.menu_id%type;
    v_product_id products.product_id%type;
  begin
    v_menu_id := f_menu_id(in_dish_name);
    v_product_id := f_prod_id(in_prod_name2);
    
    insert into recipes (menu_id, product_id, quantity, unit_code)
    values (v_menu_id, v_product_id, in_quan2, in_unit2);
    tekst(' składajaca się z '||in_prod_name2||' w ilości '||in_quan2||in_unit2);
  end receptura_2;
  
  procedure receptura_3 (in_dish_name menu.dish_name%type,
                        in_prod_name3 products.product_name%type, 
                        in_quan3 recipes.quantity%type, 
                        in_unit3 recipes.unit_code%type)
  is
    v_menu_id menu.menu_id%type;
    v_product_id products.product_id%type;
  begin
    v_menu_id := f_menu_id(in_dish_name);
    v_product_id := f_prod_id(in_prod_name3);
    
    insert into recipes (menu_id, product_id, quantity, unit_code)
    values (v_menu_id, v_product_id, in_quan3, in_unit3);
    tekst(' składajaca się z '||in_prod_name3||' w ilości '||in_quan3||in_unit3);
  end receptura_3;
  
  procedure receptura_4 (in_dish_name menu.dish_name%type,
                        in_prod_name4 products.product_name%type, 
                        in_quan4 recipes.quantity%type, 
                        in_unit4 recipes.unit_code%type)
  is
    v_menu_id menu.menu_id%type;
    v_product_id products.product_id%type;
  begin
    v_menu_id := f_menu_id(in_dish_name);
    v_product_id := f_prod_id(in_prod_name4);
    
    insert into recipes (menu_id, product_id, quantity, unit_code)
    values (v_menu_id, v_product_id, in_quan4, in_unit4);
    tekst(' składajaca się z '||in_prod_name4||' w ilości '||in_quan4||in_unit4);
  end receptura_4;
  
  procedure receptura_5 (in_dish_name menu.dish_name%type,
                        in_prod_name5 products.product_name%type, 
                        in_quan5 recipes.quantity%type, 
                        in_unit5 recipes.unit_code%type)
  is
    v_menu_id menu.menu_id%type;
    v_product_id products.product_id%type;
  begin
    v_menu_id := f_menu_id(in_dish_name);
    v_product_id := f_prod_id(in_prod_name5);
    
    insert into recipes (menu_id, product_id, quantity, unit_code)
    values (v_menu_id, v_product_id, in_quan5, in_unit5);
    tekst(' składajaca się z '||in_prod_name5||' w ilości '||in_quan5||in_unit5);
  end receptura_5;
  
  procedure receptura_6 (in_dish_name menu.dish_name%type,
                        in_prod_name6 products.product_name%type, 
                        in_quan6 recipes.quantity%type, 
                        in_unit6 recipes.unit_code%type)
  is
    v_menu_id menu.menu_id%type;
    v_product_id products.product_id%type;
  begin
    v_menu_id := f_menu_id(in_dish_name);
    v_product_id := f_prod_id(in_prod_name6);
    
    insert into recipes (menu_id, product_id, quantity, unit_code)
    values (v_menu_id, v_product_id, in_quan6, in_unit6);
    tekst(' składajaca się z '||in_prod_name6||' w ilości '||in_quan6||in_unit6);
  end receptura_6;
  
  procedure receptura_7 (in_dish_name menu.dish_name%type,
                        in_prod_name7 products.product_name%type, 
                        in_quan7 recipes.quantity%type, 
                        in_unit7 recipes.unit_code%type)
  is
    v_menu_id menu.menu_id%type;
    v_product_id products.product_id%type;
  begin
    v_menu_id := f_menu_id(in_dish_name);
    v_product_id := f_prod_id(in_prod_name7);
    
    insert into recipes (menu_id, product_id, quantity, unit_code)
    values (v_menu_id, v_product_id, in_quan7, in_unit7);
    tekst(' składajaca się z '||in_prod_name7||' w ilości '||in_quan7||in_unit7);
  end receptura_7;
  
  procedure receptura_8 (in_dish_name menu.dish_name%type,
                        in_prod_name8 products.product_name%type, 
                        in_quan8 recipes.quantity%type, 
                        in_unit8 recipes.unit_code%type)
  is
    v_menu_id menu.menu_id%type;
    v_product_id products.product_id%type;
  begin
    v_menu_id := f_menu_id(in_dish_name);
    v_product_id := f_prod_id(in_prod_name8);
    
    insert into recipes (menu_id, product_id, quantity, unit_code)
    values (v_menu_id, v_product_id, in_quan8, in_unit8);
    tekst(' składajaca się z '||in_prod_name8||' w ilości '||in_quan8||in_unit8);
  end receptura_8;
  
  procedure receptura_9 (in_dish_name menu.dish_name%type,
                        in_prod_name9 products.product_name%type, 
                        in_quan9 recipes.quantity%type, 
                        in_unit9 recipes.unit_code%type)
  is
    v_menu_id menu.menu_id%type;
    v_product_id products.product_id%type;
  begin
    v_menu_id := f_menu_id(in_dish_name);
    v_product_id := f_prod_id(in_prod_name9);
    
    insert into recipes (menu_id, product_id, quantity, unit_code)
    values (v_menu_id, v_product_id, in_quan9, in_unit9);
    tekst(' składajaca się z '||in_prod_name9||' w ilości '||in_quan9||in_unit9);
  end receptura_9;
  
  procedure receptura_10 (in_dish_name menu.dish_name%type,
                        in_prod_name10 products.product_name%type, 
                        in_quan10 recipes.quantity%type, 
                        in_unit10 recipes.unit_code%type)
  is
    v_menu_id menu.menu_id%type;
    v_product_id products.product_id%type;
  begin
    v_menu_id := f_menu_id(in_dish_name);
    v_product_id := f_prod_id(in_prod_name10);
    
    insert into recipes (menu_id, product_id, quantity, unit_code)
    values (v_menu_id, v_product_id, in_quan10, in_unit10);
    tekst(' składajaca się z '||in_prod_name10||' w ilości '||in_quan10||in_unit10);
  end receptura_10;
  
  procedure receptura ( in_dish_name menu.dish_name%type,
                        in_prod_name1 products.product_name%type, 
                        in_quan1 recipes.quantity%type, 
                        in_unit1 recipes.unit_code%type,
                        in_prod_name2 products.product_name%type default null, 
                        in_quan2 recipes.quantity%type default null, 
                        in_unit2 recipes.unit_code%type default null,
                        in_prod_name3 products.product_name%type default null, 
                        in_quan3 recipes.quantity%type default null, 
                        in_unit3 recipes.unit_code%type default null,
                        in_prod_name4 products.product_name%type default null, 
                        in_quan4 recipes.quantity%type default null, 
                        in_unit4 recipes.unit_code%type default null,
                        in_prod_name5 products.product_name%type default null, 
                        in_quan5 recipes.quantity%type default null, 
                        in_unit5 recipes.unit_code%type default null,
                        in_prod_name6 products.product_name%type default null, 
                        in_quan6 recipes.quantity%type default null, 
                        in_unit6 recipes.unit_code%type default null,
                        in_prod_name7 products.product_name%type default null, 
                        in_quan7 recipes.quantity%type default null, 
                        in_unit7 recipes.unit_code%type default null,
                        in_prod_name8 products.product_name%type default null, 
                        in_quan8 recipes.quantity%type default null, 
                        in_unit8 recipes.unit_code%type default null,
                        in_prod_name9 products.product_name%type default null, 
                        in_quan9 recipes.quantity%type default null, 
                        in_unit9 recipes.unit_code%type default null,
                        in_prod_name10 products.product_name%type default null, 
                        in_quan10 recipes.quantity%type default null, 
                        in_unit10 recipes.unit_code%type default null)
  is
  begin
    receptura_1(in_dish_name, in_prod_name1, in_quan1, in_unit1);
    receptura_2(in_dish_name, in_prod_name2, in_quan2, in_unit2);
    receptura_3(in_dish_name, in_prod_name3, in_quan3, in_unit3);
    receptura_4(in_dish_name, in_prod_name4, in_quan4, in_unit4);
    receptura_5(in_dish_name, in_prod_name5, in_quan5, in_unit5);
    receptura_6(in_dish_name, in_prod_name6, in_quan6, in_unit6);
    receptura_7(in_dish_name, in_prod_name7, in_quan7, in_unit7);
    receptura_8(in_dish_name, in_prod_name8, in_quan8, in_unit8);
    receptura_9(in_dish_name, in_prod_name9, in_quan9, in_unit9);
    receptura_10(in_dish_name, in_prod_name10, in_quan10, in_unit10);
  exception
    when no_data_found then null;
  end receptura;
  
  function f_dep_code (in_dep_name departments.department_name%type) return varchar2
  is
    v_dep_code departments.department_code%type;
  begin
    select department_code
    into v_dep_code
    from departments
    where department_name = in_dep_name;
  
    return v_dep_code;
  end f_dep_code;
  
  function f_man_id (in_first employees.first_name%type, in_last employees.last_name%type) return number
  is
    v_man_id employees.employee_id%type;
  begin
    select employee_id
    into v_man_id
    from employees
    where first_name = in_first and last_name = in_last;
  
    return v_man_id;
  end f_man_id;
  
  procedure pracownik ( in_first employees.first_name%type, 
                                        in_last employees.last_name%type, 
                                        in_pesel employees.pesel%type, 
                                        in_dep departments.department_name%type, 
                                        in_salary employees.salary%type, 
                                        in_man_f employees.first_name%type default null, 
                                        in_man_l employees.last_name%type default null)
  is
    v_dep_code departments.department_code%type;
    v_man_id employees.employee_id%type;
  begin
    v_dep_code := f_dep_code(in_dep);
    v_man_id := f_man_in(in_man_f, in_man_l);
  
    insert into employees (first_name, last_name, pesel, department_code, salary, manager_id)
    values (in_first, in_last, in_pesel, v_dep_code, in_salary, v_man_id);
  
    tekst('Wstawiono pracownika '||in_first||' '||in_last||' o nr. pesel '||in_pesel||' pracujacego na stanowisku '||in_dep||
    ' zarabiajacego '||in_salary||' którego przełożonym będzie '||in_man_f||' '||in_man_l);
  end pracownik;
  
end;
